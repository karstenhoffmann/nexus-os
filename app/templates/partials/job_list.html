<div class="table-wrapper">
<table class="data-table">
  <thead>
    <tr>
      <th>ID</th>
      <th>Status</th>
      <th>Items</th>
      <th>Gestartet</th>
      <th>Aktion</th>
    </tr>
  </thead>
  <tbody>
    {% for job in jobs %}
    <tr>
      <td><a href="/readwise/jobs/{{ job.id }}"><code>{{ job.id[:8] }}</code></a></td>
      <td><a href="/readwise/jobs/{{ job.id }}">{{ job.status.value }}</a></td>
      <td>
        {% if job.items_total and job.items_imported <= job.items_total %}
          {{ job.items_imported }} von {{ job.items_total }}
        {% else %}
          {{ job.items_imported }} verarbeitet
        {% endif %}
        {% if job.items_merged > 0 %}({{ job.items_merged }} bereits vorhanden){% endif %}
        {% if job.items_failed > 0 %}<span class="text-error">({{ job.items_failed }} Fehler)</span>{% endif %}
      </td>
      <td>{{ job.started_at.strftime('%Y-%m-%d %H:%M') }}</td>
      <td>
        {% if job.status.value in ['running', 'pending'] %}
        <button hx-post="/readwise/jobs/{{ job.id }}/cancel"
                hx-target="#job-list"
                hx-swap="innerHTML"
                hx-confirm="Import wirklich abbrechen?"
                class="btn btn-sm btn-warning">Abbrechen</button>
        {% elif job.status.value in ['completed', 'failed', 'cancelled'] %}
        <button hx-delete="/readwise/jobs/{{ job.id }}"
                hx-target="#job-list"
                hx-swap="innerHTML"
                hx-confirm="Job wirklich loeschen?"
                class="btn btn-sm btn-danger">Loeschen</button>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
