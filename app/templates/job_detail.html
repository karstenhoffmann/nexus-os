{% extends "base.html" %}
{% block content %}

<div class="breadcrumb">
  <a href="/readwise/import">&larr; Zurueck zum Import</a>
</div>

{% if error %}
<div class="card error">{{ error }}</div>
{% endif %}

{% if job %}
<div class="card">
  <h1>Import Job</h1>
  <p class="meta">ID: <code>{{ job.id }}</code></p>

  <table class="detail-table">
    <tr>
      <th>Status</th>
      <td>
        <span class="status-badge status-{{ job.status.value }}">{{ job.status.value }}</span>
      </td>
    </tr>
    <tr>
      <th>Gestartet</th>
      <td>{{ job.started_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
    </tr>
    <tr>
      <th>Letzte Aktivitaet</th>
      <td>{{ job.last_activity.strftime('%Y-%m-%d %H:%M:%S') }}</td>
    </tr>
    <tr>
      <th>Fortschritt</th>
      <td>
        {% if job.items_total %}
          {{ job.items_imported }} von {{ job.items_total }}
        {% else %}
          {{ job.items_imported }}
        {% endif %}
      </td>
    </tr>
    <tr>
      <th>Items gemerged</th>
      <td>{{ job.items_merged }}</td>
    </tr>
    <tr>
      <th>Items fehlgeschlagen</th>
      <td>{% if job.items_failed > 0 %}<span class="text-error">{{ job.items_failed }}</span>{% else %}0{% endif %}</td>
    </tr>
    <tr>
      <th>Reader API</th>
      <td>{{ "Fertig" if job.reader_done else "Offen" }}</td>
    </tr>
    <tr>
      <th>Export API</th>
      <td>{{ "Fertig" if job.export_done else "Offen" }}</td>
    </tr>
    {% if job.error %}
    <tr>
      <th>Fehler</th>
      <td class="text-error">{{ job.error }}</td>
    </tr>
    {% endif %}
  </table>

  {% if job.status.value in ['paused', 'failed'] %}
  <div style="margin-top: 1rem;">
    <a href="/readwise/import" class="btn">Import fortsetzen</a>
  </div>
  {% endif %}
</div>
{% endif %}

<style>
.detail-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
}
.detail-table th,
.detail-table td {
  padding: 0.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border, #ddd);
}
.detail-table th {
  width: 180px;
  color: var(--text-muted, #666);
}
.status-badge {
  display: inline-block;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
}
.status-pending { background: var(--bg-secondary, #e0e0e0); }
.status-running { background: var(--primary, #4a90d9); color: white; }
.status-paused { background: var(--warning, #e6a700); color: white; }
.status-completed { background: var(--success, #2e7d32); color: white; }
.status-failed { background: var(--error, #c62828); color: white; }
.text-error { color: var(--error, #c62828); }
.btn {
  display: inline-block;
  padding: 0.5rem 1rem;
  background: var(--primary, #4a90d9);
  color: white;
  text-decoration: none;
  border-radius: 4px;
}
</style>

{% endblock %}
